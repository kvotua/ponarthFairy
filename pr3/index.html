<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Кольца Кенигсбега</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Montserrat', Arial, sans-serif;
            background: linear-gradient(180deg, #b2c94b 0%, #7fae8b 100%);
        }
        .main-bg-container {
            min-height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            background: linear-gradient(180deg, #b2c94b 0%, #7fae8b 100%);
        }
        .background-image-block {
            position: relative;
            width: calc(100vw - 60px);
            max-width: 1400px;
            height: 700px;
            margin: 0 auto;
            margin-top: 40px;
            border-radius: 120px;
            overflow: hidden;
            z-index: 2;
            background: #222;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        .background-image-block img.bg-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transform: translateZ(-10px) scale(1.2);
            transition: none;
            object-position: center;
            min-width: 100%;
            min-height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
        .background-image-block img.bg-img.slide-out {
            transform: translateZ(-10px) scale(1.2) translateX(-100%);
        }
        .background-image-block img.bg-img.slide-in {
            transform: translateZ(-10px) scale(1.2) translateX(100%);
        }
        .headline-overlay {
            position: absolute;
            top: 30px;
            left: 0;
            width: 100%;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding-left: 40px;
            transition: transform 0.1s ease-out;
        }
        .main-title, .subtitle {
            font-family: 'Montserrat', Arial, sans-serif;
            font-weight: 900;
            color: #fff;
            font-size: 6vw;
            letter-spacing: 0.04em;
            line-height: 1;
            margin: 0;
            text-align: left;
            text-transform: uppercase;
            text-shadow: 0 2px 12px rgba(0,0,0,0.25);
        }
        .subtitle {
            margin-top: 0;
        }
        .ring-3d {
            position: absolute;
            left: 50%;
            top: 59%;
            transform: translate(-50%, -50%);
            width: 520px;
            height: 640px;
            z-index: 5;
            pointer-events: auto;
            user-select: none;
            transition: transform 0.1s ease-out;
        }
        .model-name {
            position: absolute;
            left: 0;
            right: 0;
            bottom: 30px;
            text-align: center;
            font-family: 'Playfair Display', serif;
            font-size: 2vw;
            color: #fff;
            letter-spacing: 0.18em;
            font-weight: 700;
            text-shadow: 0 2px 8px rgba(0,0,0,0.18);
            z-index: 4;
            text-transform: uppercase;
        }
        .description-block {
            width: calc(100vw - 60px);
            max-width: 1600px;
            margin: 40px auto 0 auto;
            text-align: left;
        }
        .description {
            font-family: 'Playfair Display', serif;
            font-size: 1.3vw;
            color: #fff;
            font-weight: 400;
            letter-spacing: 0.25em;
            margin: 0;
            text-align: left;
            text-shadow: none;
        }
        @media (max-width: 1700px) {
            .background-image-block, .description-block {
                max-width: 98vw;
            }
        }
        @media (max-width: 700px) {
            .main-title, .subtitle {
                font-size: 12vw;
            }
            .background-image-block {
                height: 220px;
                border-radius: 30px;
                width: calc(100vw - 10px);
                max-width: 100vw;
            }
            .ring-3d {
                width: 240px;
                height: 320px;
                transform: translate(-50%, -40%);
            }
            .model-name {
                font-size: 4vw;
                bottom: 5px;
            }
            .description-block {
                margin-top: 20px;
                width: calc(100vw - 10px);
                max-width: 100vw;
            }
            .description {
                font-size: 4vw;
            }
        }
        .slider-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            background: rgba(0,0,0,0.18);
            color: #fff;
            font-size: 2.5rem;
            cursor: pointer;
            z-index: 20;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        .slider-arrow.right {
            right: 32px;
        }
        .slider-arrow:hover {
            background: rgba(0,0,0,0.35);
        }
    </style>
</head>
<body>
    <div class="main-bg-container">
        <div class="background-image-block">
            <img src="mosin.png" alt="Фон мох" class="bg-img" id="bg-img">
            <div class="headline-overlay">
                <div class="main-title" id="main-title">КОЛЬЦА</div>
                <div class="subtitle" id="subtitle">КЕНИГСБЕГА</div>
            </div>
            <div class="ring-3d" id="ring-3d"></div>
            <div class="model-name" id="model-name">АМАЛИЕНАЛУ ДЖАНГЛ</div>
            <button class="slider-arrow right" id="next-slide" aria-label="Следующий слайд">&#8250;</button>
        </div>
        <div class="description-block">
            <div class="description" id="description-text">
                Уникальное украшение, вдохновленное природными пейзажами пустынь, где песок и ветер создают величественные формы.
            </div>
            <div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <script>
    // Parallax effect
    const UPDATE = ({ x, y }) => {
        // Нормализуем координаты мыши относительно центра экрана
        const xNorm = (x / window.innerWidth - 0.5) * 2;
        const yNorm = (y / window.innerHeight - 0.5) * 2;

        // Apply parallax to elements
        const bgImg = document.querySelector('.bg-img');
        const headline = document.querySelector('.headline-overlay');

        // Применяем одинаковую логику движения для фона и текста
        bgImg.style.transform = `translateZ(-10px) scale(1.2) translate(${xNorm * -50}px, ${yNorm * -50}px)`;
        headline.style.transform = `translate(${xNorm * -50}px, ${yNorm * -50}px)`;
    };

    // Добавляем обработчик движения мыши
    window.addEventListener("mousemove", (e) => {
        UPDATE({ x: e.clientX, y: e.clientY });
    });

    const handleOrientation = ({ beta, gamma }) => {
        const isLandscape = window.matchMedia("(orientation: landscape)").matches;
        const xVal = Math.max(-1, Math.min(1, isLandscape ? (beta || 0) / 45 : (gamma || 0) / 45));
        const yVal = Math.max(-1, Math.min(1, isLandscape ? Math.abs(gamma || 0) / 45 : (beta || 0) / 45));

        document.documentElement.style.setProperty("--x", xVal);
        document.documentElement.style.setProperty("--y", yVal);

        // Apply parallax to elements
        const bgImg = document.querySelector('.bg-img');
        const ring3d = document.querySelector('.ring-3d');
        const headline = document.querySelector('.headline-overlay');

        bgImg.style.transform = `translateZ(-10px) scale(2) translate(${xVal * 30}px, ${yVal * 20}px)`;
        ring3d.style.transform = `translate(-50%, -50%) translate(${xVal * 40}px, ${yVal * 30}px)`;
        headline.style.transform = `translate(${xVal * 20}px, ${yVal * 15}px)`;
    };

    const START = () => {
        if (DeviceOrientationEvent?.requestPermission) {
            DeviceOrientationEvent.requestPermission().then((result) => {
                if (result === "granted") {
                    window.addEventListener("deviceorientation", handleOrientation);
                }
            });
        } else {
            window.addEventListener("deviceorientation", handleOrientation);
        }
    };

    document.body.addEventListener("click", START, { once: true });

    // 3D кольцо с "фигуркой" сверху
    const container = document.getElementById('ring-3d');
    const scene = new THREE.Scene();
    scene.background = null;
    const camera = new THREE.PerspectiveCamera(60, container.clientWidth / container.clientHeight, 0.1, 1000);
    camera.position.set(0, 0, 6);
    const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
    renderer.setSize(container.clientWidth, container.clientHeight);
    renderer.setClearColor(0x000000, 0);
    container.appendChild(renderer.domElement);
    
    // Добавляем обработчик событий для контейнера
    container.style.pointerEvents = 'auto';
    container.style.touchAction = 'none';
    
    // Свет
    scene.add(new THREE.AmbientLight(0xffffff, 0.7));
    const dirLight = new THREE.DirectionalLight(0xffffff, 0.9);
    dirLight.position.set(2, 2, 5);
    scene.add(dirLight);
    // Кольцо (тор)
    const ringGeometry = new THREE.TorusGeometry(1.1, 0.35, 32, 100);
    const ringMaterial = new THREE.MeshPhongMaterial({ color: 0xcccccc, shininess: 100, specular: 0xffffff });
    const ring = new THREE.Mesh(ringGeometry, ringMaterial);
    scene.add(ring);
    // "Пантера" — стилизованный объект (овал + шарики)
    const pantherGroup = new THREE.Group();
    // Тело (овал)
    const bodyGeometry = new THREE.SphereGeometry(0.38, 32, 32);
    bodyGeometry.scale(1.5, 0.7, 0.7);
    const body = new THREE.Mesh(bodyGeometry, new THREE.MeshPhongMaterial({ color: 0x888888, shininess: 80 }));
    body.position.set(0, 0.55, 0);
    pantherGroup.add(body);
    // Голова (шар)
    const head = new THREE.Mesh(new THREE.SphereGeometry(0.22, 32, 32), new THREE.MeshPhongMaterial({ color: 0x888888, shininess: 80 }));
    head.position.set(0.38, 0.7, 0);
    pantherGroup.add(head);
    // Лапы (шарики)
    for (let i = 0; i < 2; i++) {
        const paw = new THREE.Mesh(new THREE.SphereGeometry(0.11, 16, 16), new THREE.MeshPhongMaterial({ color: 0x888888, shininess: 80 }));
        paw.position.set(0.38 + (i ? 0.18 : -0.18), 0.5, 0.18);
        pantherGroup.add(paw);
    }
    // Хвост (цилиндр)
    const tail = new THREE.Mesh(new THREE.CylinderGeometry(0.05, 0.05, 0.7, 16), new THREE.MeshPhongMaterial({ color: 0x888888, shininess: 80 }));
    tail.position.set(-0.6, 0.5, 0);
    tail.rotation.z = Math.PI / 3;
    pantherGroup.add(tail);
    pantherGroup.position.set(0.2, 0.7, 0);
    scene.add(pantherGroup);
    // Управление мышью
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.08;
    controls.enablePan = false;
    controls.rotateSpeed = 0.5;
    controls.minDistance = 4;
    controls.maxDistance = 8;
    controls.enableZoom = false;
    controls.enabled = true;
    // Адаптация к изменению размера
    window.addEventListener('resize', () => {
        const w = container.clientWidth;
        const h = container.clientHeight;
        camera.aspect = w / h;
        camera.updateProjectionMatrix();
        renderer.setSize(w, h);
    });
    // Анимация
    function animate() {
        requestAnimationFrame(animate);
        controls.update();
        renderer.render(scene, camera);
    }
    animate();
    // Слайды
    const slides = [
        {
            bg: 'mosin.png',
            model: 'АМАЛИЕНАЛУ ДЖАНГЛ',
            description: 'Уникальное украшение, вдохновленное природными пейзажами пустынь, где песок и ветер создают величественные формы.',
            mainTitle: 'КОЛЬЦА',
            subTitle: 'КЕНИГСБЕГА',
        },
        {
            bg: 'dune.jpg', // Добавьте этот файл в проект
            model: 'ПЕСЧАНЫЕ ДЮНЫ',
            description: 'Уникальное украшение, вдохновленное природными пейзажами пустынь, где песок и ветер создают величественные формы.',
            mainTitle: 'КОЛЬЦА',
            subTitle: 'КЕНИГСБЕГА',
        }
    ];
    let currentSlide = 0;
    const bgImg = document.getElementById('bg-img');
    const modelName = document.getElementById('model-name');
    const descriptionText = document.getElementById('description-text');
    const mainTitle = document.getElementById('main-title');
    const subTitle = document.getElementById('subtitle');
    document.getElementById('next-slide').onclick = function() {
        currentSlide = (currentSlide + 1) % slides.length;
        const slide = slides[currentSlide];
        
        // Создаем новое изображение
        const newImg = new Image();
        newImg.src = slide.bg;
        newImg.className = 'bg-img slide-in';
        
        // Добавляем новое изображение в контейнер
        const bgContainer = document.querySelector('.background-image-block');
        bgContainer.appendChild(newImg);
        
        // Запускаем анимацию перехода
        requestAnimationFrame(() => {
            const oldImg = document.querySelector('.bg-img:not(:last-child)');
            if (oldImg) {
                oldImg.classList.add('slide-out');
                newImg.style.transform = 'translateZ(-10px) scale(1.2) translateX(0)';
                setTimeout(() => oldImg.remove(), 800);
            }
        });

        // Плавно обновляем текст
        modelName.style.opacity = '0';
        descriptionText.style.opacity = '0';
        mainTitle.style.opacity = '0';
        subTitle.style.opacity = '0';

        setTimeout(() => {
            modelName.textContent = slide.model;
            descriptionText.textContent = slide.description;
            mainTitle.textContent = slide.mainTitle;
            subTitle.textContent = slide.subTitle;

            modelName.style.opacity = '1';
            descriptionText.style.opacity = '1';
            mainTitle.style.opacity = '1';
            subTitle.style.opacity = '1';
        }, 400);
    };
    </script>
</body>
</html>
